# 环境配置说明

## 配置文件结构

项目现在支持多环境配置，包含以下配置文件：

- `application.yml` - 主配置文件，包含通用配置
- `application-dev.yml` - 开发环境配置
- `application-prod.yml` - 生产环境配置

## 环境切换方式

### 1. 通过启动参数切换环境

```bash
# 开发环境
java -jar spiritual-pressure.jar --spring.profiles.active=dev

# 生产环境  
java -jar spiritual-pressure.jar --spring.profiles.active=prod
```

### 2. 通过环境变量切换环境

```bash
# 设置环境变量（Windows）
set SPRING_PROFILES_ACTIVE=dev

# 设置环境变量（Linux/Mac）
export SPRING_PROFILES_ACTIVE=prod
```

### 3. 在IDE中配置

在IntelliJ IDEA中：
- 打开运行配置
- 在VM options中添加：`-Dspring.profiles.active=dev`

## 环境配置差异

### 开发环境 (dev)
- 数据库：localhost:3306
- Redis：localhost:6379
- 日志级别：DEBUG
- Hibernate SQL显示：开启
- 文件上传目录：D:/Image/ (Windows) 或 /tmp/images/ (Linux/Mac)
- 调试模式：开启

### 生产环境 (prod)
- 数据库：121.40.144.69:3306
- Redis：121.40.144.69:6379
- 日志级别：INFO
- Hibernate SQL显示：关闭
- 文件上传目录：/home/app/images/
- 安全配置：增强
- 性能优化：开启

## 生产环境敏感信息配置

生产环境使用环境变量来保护敏感信息：

```bash
# 数据库密码
export DB_PASSWORD=your_secure_password

# Redis密码
export REDIS_PASSWORD=your_redis_password

# JWT密钥
export JWT_SECRET=your_secure_jwt_secret

# 邮箱配置
export MAIL_USERNAME=your_email@example.com
export MAIL_PASSWORD=your_email_password
```

## 验证环境配置

启动应用后，可以通过以下方式验证当前激活的环境：

1. 查看启动日志中的 `Active profiles` 信息
2. 访问健康检查端点：`http://localhost:2025/manage/health`
3. 查看应用日志文件

## 注意事项

1. 生产环境配置中的敏感信息必须通过环境变量设置
2. 开发环境适合本地调试，生产环境适合线上部署
3. 配置文件中的占位符（如 `${DB_PASSWORD}`）会在运行时被实际值替换
4. 确保生产环境的数据库和Redis服务正常运行